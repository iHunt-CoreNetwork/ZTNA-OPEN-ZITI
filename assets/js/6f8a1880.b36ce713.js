"use strict";(self.webpackChunkopen_ziti=self.webpackChunkopen_ziti||[]).push([[1422],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),l=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=l(n),f=i,m=p["".concat(s,".").concat(f)]||p[f]||d[f]||a;return n?r.createElement(m,c(c({ref:t},u),{},{components:n})):r.createElement(m,c({ref:t},u))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,c=new Array(a);c[0]=f;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[p]="string"==typeof e?e:i,c[1]=o;for(var l=2;l<a;l++)c[l]=n[l];return r.createElement.apply(null,c)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},34948:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>c,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var r=n(87462),i=(n(67294),n(3905));const a={},c="Certificate Management",o={unversionedId:"learn/core-concepts/security/authentication/certificate-management",id:"learn/core-concepts/security/authentication/certificate-management",title:"Certificate Management",description:"Clients, routers, and the controller use x509 client and server certificates. Client authentication",source:"@site/docs/learn/core-concepts/security/authentication/40-certificate-management.md",sourceDirName:"learn/core-concepts/security/authentication",slug:"/learn/core-concepts/security/authentication/certificate-management",permalink:"/docs/learn/core-concepts/security/authentication/certificate-management",draft:!1,editUrl:"https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/learn/core-concepts/security/authentication/40-certificate-management.md",tags:[],version:"current",sidebarPosition:40,frontMatter:{},sidebar:"docsSidebar",previous:{title:"Authentication Policies",permalink:"/docs/learn/core-concepts/security/authentication/authentication-policies"},next:{title:"External JWT Signers",permalink:"/docs/learn/core-concepts/security/authentication/external-jwt-signers"}},s={},l=[{value:"Router Certificate Extension",id:"router-certificate-extension",level:2},{value:"Client Certificate Extension",id:"client-certificate-extension",level:2},{value:"Client Certificate Extension",id:"client-certificate-extension-1",level:3},{value:"Request",id:"request",level:4},{value:"Response:",id:"response",level:4}],u={toc:l},p="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(p,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"certificate-management"},"Certificate Management"),(0,i.kt)("p",null,"Clients, routers, and the controller use x509 client and server certificates. Client authentication\nmethods include certificates, but router and controller authentication always uses certificates."),(0,i.kt)("p",null,"Client and Routers with certificates from the internal Edge signer PKI may request new certificates by calling the Edge API.\nRouters always have certificates from the internal Edge signer PKI. Clients can also be created with certificates from external\nPKIs via ",(0,i.kt)("a",{parentName:"p",href:"./third-party-cas"},"3rd Party CAs"),". Ziti can trust certificates from a configured external CA, but can not revoke or issue those certificates."),(0,i.kt)("h2",{id:"router-certificate-extension"},"Router Certificate Extension"),(0,i.kt)("p",null,"Routers will attempt to extend their current client and server certificates one week prior to expiration. No\nintervention is necessary on behalf of the network administrator. The request must be sent to the controller via a\npre-authenticated connection. If a router has been disconnected from the Ziti network and their client certificates\nhave expired, the router must be ",(0,i.kt)("a",{parentName:"p",href:"../enrollment#router-enrollment-extension"},"re-enrolled"),"."),(0,i.kt)("h2",{id:"client-certificate-extension"},"Client Certificate Extension"),(0,i.kt)("p",null,"Clients may determine their own client certificate extension frequency. In order to extend their current client\ncertificate issued by the Ziti PKI, they must issue the following REST request to either the\n",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/developer/api#edge-management-api"},"edge management API")," or ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/developer/api#edge-client-api"},"edge client API"),"\nafter becoming ",(0,i.kt)("a",{parentName:"p",href:"/docs/learn/core-concepts/security/sessions#full-vs-partial-authentication"},"fully authenticated"),"."),(0,i.kt)("h3",{id:"client-certificate-extension-1"},"Client Certificate Extension"),(0,i.kt)("p",null,"The Ziti SDKs provide helper functions for this process and issuing these requests manually should not be necessary."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," necessary to extend a specific authenticator may be obtained by listing the client's current authenticators\nwith ",(0,i.kt)("inlineCode",{parentName:"p"},"GET edge/*/v1/current-identity/authenticators")," where ",(0,i.kt)("inlineCode",{parentName:"p"},"*")," may be ",(0,i.kt)("inlineCode",{parentName:"p"},"management")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"client"),". The CSR provided\nmust be PEM encoded."),(0,i.kt)("h4",{id:"request"},"Request"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"POST edge/client/v1/current-identity/authenticators/{id}/extend")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'{\n  "clientCertCsr": "-----BEGIN NEW CERTIFICATE REQUEST-----\\n..."\n}\n')),(0,i.kt)("h4",{id:"response"},"Response:"),(0,i.kt)("p",null,"A new CA bundle and client certificate will be returned PEM encoded."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-text"},'{\n  "data": {\n      "ca": "-----BEGIN CERTIFICATE-----\\nMIICZTCCAeygAwIBAgIUOoTKiY",\n      "clientCert": "-----BEGIN CERTIFICATE-----\\nMIICZTCCAeygAwIBAgIUOoTKiY"\n  },\n  "meta": {}\n}\n')))}d.isMDXComponent=!0}}]);