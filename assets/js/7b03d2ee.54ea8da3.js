"use strict";(self.webpackChunkopen_ziti=self.webpackChunkopen_ziti||[]).push([[1135],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),m=a,g=c["".concat(s,".").concat(m)]||c[m]||d[m]||o;return n?r.createElement(g,i(i({ref:t},p),{},{components:n})):r.createElement(g,i({ref:t},p))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},65471:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(87462),a=n(67294),o=n(86010),i=n(72389),l=n(86043);const s={details:"details_lb9f",isBrowser:"isBrowser_bmU9",collapsibleContent:"collapsibleContent_i85q"};function u(e){return!!e&&("SUMMARY"===e.tagName||u(e.parentElement))}function p(e,t){return!!e&&(e===t||p(e.parentElement,t))}function c(e){let{summary:t,children:n,...c}=e;const d=(0,i.Z)(),m=(0,a.useRef)(null),{collapsed:g,setCollapsed:h}=(0,l.u)({initialState:!c.open}),[f,k]=(0,a.useState)(c.open),b=a.isValidElement(t)?t:a.createElement("summary",null,t??"Details");return a.createElement("details",(0,r.Z)({},c,{ref:m,open:f,"data-collapsed":g,className:(0,o.Z)(s.details,d&&s.isBrowser,c.className),onMouseDown:e=>{u(e.target)&&e.detail>1&&e.preventDefault()},onClick:e=>{e.stopPropagation();const t=e.target;u(t)&&p(t,m.current)&&(e.preventDefault(),g?(h(!1),k(!0)):h(!0))}}),b,a.createElement(l.z,{lazy:!1,collapsed:g,disableSSRStyle:!0,onCollapseTransitionEnd:e=>{h(e),k(!e)}},a.createElement("div",{className:s.collapsibleContent},n)))}const d={details:"details_b_Ee"},m="alert alert--info";function g(e){let{...t}=e;return a.createElement(c,(0,r.Z)({},t,{className:(0,o.Z)(m,d.details,t.className)}))}function h(e){const t=a.Children.toArray(e.children),n=t.find((e=>a.isValidElement(e)&&"summary"===e.props?.mdxType)),o=a.createElement(a.Fragment,null,t.filter((e=>e!==n)));return a.createElement(g,(0,r.Z)({},e,{summary:n}),o)}},85162:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(67294),a=n(86010);const o={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:n,className:i}=e;return r.createElement("div",{role:"tabpanel",className:(0,a.Z)(o.tabItem,i),hidden:n},t)}},74866:(e,t,n)=>{n.d(t,{Z:()=>N});var r=n(87462),a=n(67294),o=n(86010),i=n(12466),l=n(16550),s=n(91980),u=n(67392),p=n(50012);function c(e){return function(e){return a.Children.map(e,(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:a}}=e;return{value:t,label:n,attributes:r,default:a}}))}function d(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??c(n);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function g(e){let{queryString:t=!1,groupId:n}=e;const r=(0,l.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s._X)(o),(0,a.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(r.location.search);t.set(o,e),r.replace({...r.location,search:t.toString()})}),[o,r])]}function h(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,o=d(e),[i,l]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:o}))),[s,u]=g({queryString:n,groupId:r}),[c,h]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,o]=(0,p.Nk)(n);return[r,(0,a.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:r}),f=(()=>{const e=s??c;return m({value:e,tabValues:o})?e:null})();(0,a.useLayoutEffect)((()=>{f&&l(f)}),[f]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),h(e)}),[u,h,o]),tabValues:o}}var f=n(72389);const k={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function b(e){let{className:t,block:n,selectedValue:l,selectValue:s,tabValues:u}=e;const p=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),d=e=>{const t=e.currentTarget,n=p.indexOf(t),r=u[n].value;r!==l&&(c(t),s(r))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=p.indexOf(e.currentTarget)+1;t=p[n]??p[0];break}case"ArrowLeft":{const n=p.indexOf(e.currentTarget)-1;t=p[n]??p[p.length-1];break}}t?.focus()};return a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:i}=e;return a.createElement("li",(0,r.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>p.push(e),onKeyDown:m,onClick:d},i,{className:(0,o.Z)("tabs__item",k.tabItem,i?.className,{"tabs__item--active":l===t})}),n??t)})))}function y(e){let{lazy:t,children:n,selectedValue:r}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return a.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==r}))))}function v(e){const t=h(e);return a.createElement("div",{className:(0,o.Z)("tabs-container",k.tabList)},a.createElement(b,(0,r.Z)({},e,t)),a.createElement(y,(0,r.Z)({},e,t)))}function N(e){const t=(0,f.Z)();return a.createElement(v,(0,r.Z)({key:String(t)},e))}},20476:(e,t,n)=>{n.d(t,{ZP:()=>l});var r=n(87462),a=(n(67294),n(3905));const o={toc:[]},i="wrapper";function l(e){let{components:t,...n}=e;return(0,a.kt)(i,(0,r.Z)({},o,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("br",null),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"ziti")," CLI will help you get an API Session from the controller's management API. You will be prompted to trust any new server certificates. Your login token cache and trust store are managed by the CLI in your home directory."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"# implies https://localhost:1280\nziti edge login -u admin -p admin\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"# implies https://\nziti edge login ziti.example.com:8441 -u admin -p admin\n")))}l.isMDXComponent=!0},12810:(e,t,n)=>{n.d(t,{ZP:()=>s});var r=n(87462),a=(n(67294),n(3905)),o=n(65471);const i={toc:[]},l="wrapper";function s(e){let{components:t,...n}=e;return(0,a.kt)(l,(0,r.Z)({},i,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(o.Z,{mdxType:"Details"},(0,a.kt)("summary",null,"Configure the repository for the Debian family of distributions (Ubuntu, Mint, Pop!_OS)"),(0,a.kt)("p",null,"Install the OpenZiti repository key."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"curl -sSLf https://get.openziti.io/tun/package-repos.gpg | sudo gpg --dearmor --output /usr/share/keyrings/openziti.gpg\n")),(0,a.kt)("p",null,"Ensure the key is readable by all users."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"sudo chmod a+r /usr/share/keyrings/openziti.gpg\n")),(0,a.kt)("p",null,"Create the repository file."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"sudo tee /etc/apt/sources.list.d/openziti-release.list >/dev/null <<EOF\ndeb [signed-by=/usr/share/keyrings/openziti.gpg] https://packages.openziti.org/zitipax-openziti-deb-stable debian main\nEOF\n")),(0,a.kt)("p",null,"Update the package list."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"sudo apt update\n"))),(0,a.kt)(o.Z,{mdxType:"Details"},(0,a.kt)("summary",null,"Configure the repository for the RedHat family (Fedora, Rocky, Alma)"),(0,a.kt)("p",null,"Create the repository file."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"sudo tee /etc/yum.repos.d/openziti-release.repo >/dev/null <<\\EOF\n[OpenZitiRelease]\nname=OpenZiti Release\nbaseurl=https://packages.openziti.org/zitipax-openziti-rpm-stable/redhat/$basearch\nenabled=1\ngpgcheck=0\ngpgkey=https://packages.openziti.org/zitipax-openziti-rpm-stable/redhat/$basearch/repodata/repomd.xml.key\nrepo_gpgcheck=1\nEOF\n")),(0,a.kt)("p",null,"Update the package list."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"sudo dnf update\n"))))}s.isMDXComponent=!0},86004:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>u,default:()=>h,frontMatter:()=>s,metadata:()=>p,toc:()=>d});var r=n(87462),a=(n(67294),n(3905)),o=n(74866),i=n(85162),l=(n(20476),n(12810));const s={title:"Router Deployment"},u=void 0,p={unversionedId:"guides/deployments/linux/router/deploy",id:"guides/deployments/linux/router/deploy",title:"Router Deployment",description:"This article is about deploying a Ziti router as a Linux system service. This page provides an overview of the architecture.",source:"@site/docs/guides/deployments/10-linux/20-router/10-deploy.mdx",sourceDirName:"guides/deployments/10-linux/20-router",slug:"/guides/deployments/linux/router/deploy",permalink:"/docs/guides/deployments/linux/router/deploy",draft:!1,editUrl:"https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/guides/deployments/10-linux/20-router/10-deploy.mdx",tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"Router Deployment"},sidebar:"docsSidebar",previous:{title:"Migrate",permalink:"/docs/guides/deployments/linux/controller/migrate"},next:{title:"Configuration",permalink:"/docs/guides/deployments/linux/router/router-configuration"}},c={},d=[{value:"Installation",id:"installation",level:2},{value:"Bootstrapping",id:"bootstrapping",level:2},{value:"Bootstrapping the Configuration",id:"bootstrapping-the-configuration",level:3},{value:"Bootstrapping the Enrollment",id:"bootstrapping-the-enrollment",level:3},{value:"Firewall",id:"firewall",level:2},{value:"Logging",id:"logging",level:2},{value:"Uninstall",id:"uninstall",level:2}],m={toc:d},g="wrapper";function h(e){let{components:t,...n}=e;return(0,a.kt)(g,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This article is about deploying a Ziti router as a Linux system service. ",(0,a.kt)("a",{parentName:"p",href:"/docs/learn/introduction/components#openziti-router"},"This page")," provides an overview of the architecture."),(0,a.kt)("p",null,"Routers provide Ziti network entry and exit points for clients and smart routing through the mesh. You must have at least one router that is advertising an edge connection to clients. If you have more than one router, you must configure transport links between them to form the fabric mesh."),(0,a.kt)("h2",{id:"installation"},"Installation"),(0,a.kt)("p",null,"The router package ",(0,a.kt)("inlineCode",{parentName:"p"},"openziti-router")," provides a systemd service unit and optional bootstrapping. The package depends on the ",(0,a.kt)("inlineCode",{parentName:"p"},"openziti")," package which provides the ",(0,a.kt)("inlineCode",{parentName:"p"},"ziti")," CLI. The easiest way to install both is the cross-platform install script for RPM and Debian distributions."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"curl -sS https://get.openziti.io/install.bash \\\n| sudo bash -s openziti-router\n")),(0,a.kt)(l.ZP,{mdxType:"LinuxPackageRepo"}),(0,a.kt)("h2",{id:"bootstrapping"},"Bootstrapping"),(0,a.kt)("p",null,"You can opt-in to generating a configuration file and enrolling the router automatically. You will be prompted for the most relevant configuration values when installing interactively unless the answer is already known."),(0,a.kt)("p",null,"Bootstrapping consists of these steps:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Generate a one-shot configuration file from env answers and defaults."),(0,a.kt)("li",{parentName:"ol"},"Enroll the router with the controller.")),(0,a.kt)("p",null,"At a minimum, you must set these to opt-in to bootstrapping."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"In ",(0,a.kt)("inlineCode",{parentName:"li"},"/opt/openziti/etc/router/service.env")," (the answer file for the service)",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Set ",(0,a.kt)("inlineCode",{parentName:"li"},"ZITI_BOOTSTRAP=true")))),(0,a.kt)("li",{parentName:"ol"},"In ",(0,a.kt)("inlineCode",{parentName:"li"},"/opt/openziti/etc/router/bootstrap.env")," (the answer file for bootstrapping the router)",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Set ",(0,a.kt)("inlineCode",{parentName:"li"},"ZITI_ENROLL_TOKEN")," to the resulting token (JWT)")))),(0,a.kt)("p",null,"Additionally, you probably want to set these:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"In ",(0,a.kt)("inlineCode",{parentName:"li"},"/opt/openziti/etc/router/bootstrap.env")," (the answer file for bootstrapping the router)",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Set ",(0,a.kt)("inlineCode",{parentName:"li"},"ZITI_CTRL_ADVERTISED_ADDRESS")," to the FQDN of the controller (default: localhost)."),(0,a.kt)("li",{parentName:"ol"},"Set ",(0,a.kt)("inlineCode",{parentName:"li"},"ZITI_ROUTER_ADVERTISED_ADDRESS")," to the permanent FQDN of the router (default: localhost). This value can not be changed after enrollment."),(0,a.kt)("li",{parentName:"ol"},"Set ",(0,a.kt)("inlineCode",{parentName:"li"},"ZITI_ROUTER_MODE")," (default: none) if this router's built-in tunneler will provide a proxy for services. Mode ",(0,a.kt)("inlineCode",{parentName:"li"},"tproxy")," requires additional kernel capabilities in ",(0,a.kt)("inlineCode",{parentName:"li"},"/etc/systemd/system/ziti-router.service.d/override.conf")," and DNS resolver configuration for the host.")))),(0,a.kt)("h3",{id:"bootstrapping-the-configuration"},"Bootstrapping the Configuration"),(0,a.kt)("p",null,"The router's configuration is loaded from a YAML file (",(0,a.kt)("a",{parentName:"p",href:"/docs/reference/configuration/router"},"reference"),"). The Linux system service will generate a valid configuration during the first startup, unless one already exists. You can modify the generated configuration in ",(0,a.kt)("inlineCode",{parentName:"p"},"/var/lib/ziti-router/config.yml"),"."),(0,a.kt)("p",null,"The filename of the configuration file, relative to the router's working directory, is given as an argument, e.g., ",(0,a.kt)("inlineCode",{parentName:"p"},"entrypoint.bash run config.yml")," in ",(0,a.kt)("inlineCode",{parentName:"p"},"/lib/systemd/system/ziti-router.service")," as an argument to the ",(0,a.kt)("inlineCode",{parentName:"p"},"ExecStart")," command. You may override this in ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/systemd/system/ziti-router.service.d/override.conf"),"."),(0,a.kt)("p",null,"Explore configuration option variables by running ",(0,a.kt)("inlineCode",{parentName:"p"},"ziti create config environment --help"),". Any of these may be set in ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/openziti/etc/router/bootstrap.env")," to influence the generated configuration."),(0,a.kt)("p",null,"Disable generating a configuration by setting ",(0,a.kt)("inlineCode",{parentName:"p"},"ZITI_BOOTSTRAP_CONFIG=false")," in ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/openziti/etc/router/service.env"),"."),(0,a.kt)("h3",{id:"bootstrapping-the-enrollment"},"Bootstrapping the Enrollment"),(0,a.kt)("p",null,"You must provide an enrollment token. Obtain the token by administratively creating the router."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text",metastring:'title="Create a router"',title:'"Create',a:!0,'router"':!0},'ziti edge create edge-router "AcmeRouter1" \\\n    --tunneler-enabled \\\n    --jwt-output-file path/to/token.jwt\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/docs/guides/deployments/linux/router/cli-mgmt"},"Learn more about managing routers with the CLI"),"."),(0,a.kt)("p",null,"The systemd service looks for the token in ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/openziti/etc/router/.token")," if env var ",(0,a.kt)("inlineCode",{parentName:"p"},"ZITI_ENROLL_TOKEN")," is empty. The file must be readable by root (not others)."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"ZITI_ENROLL_TOKEN")," may be defined in ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/openziti/etc/router/bootstrap.env"),"."),(0,a.kt)("p",null,"The router will enroll with the controller during the first startup. The one-time enrollment token is consumed during the enrollment process and a private key is generated in the router's working directory."),(0,a.kt)("p",null,"Disable bootstrapping enrollment by setting ",(0,a.kt)("inlineCode",{parentName:"p"},"ZITI_BOOTSTRAP_ENROLLMENT=false")," in ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/openziti/etc/router/service.env"),"."),(0,a.kt)("h2",{id:"firewall"},"Firewall"),(0,a.kt)("p",null,"The router listens on a single configurable TCP port: ",(0,a.kt)("inlineCode",{parentName:"p"},"3022/tcp"),". Ziti clients use ALPN to negotiate a connection to the edge (",(0,a.kt)("inlineCode",{parentName:"p"},"ziti-edge"),"), fabric links (",(0,a.kt)("inlineCode",{parentName:"p"},"ziti-link"),"), or health-check APIs (",(0,a.kt)("inlineCode",{parentName:"p"},"h2"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"http/1.1"),")."),(0,a.kt)("p",null,"You may set ",(0,a.kt)("inlineCode",{parentName:"p"},"ZITI_ROUTER_PORT")," in ",(0,a.kt)("inlineCode",{parentName:"p"},"/opt/openziti/etc/router/bootstrap.env")," to bootstrap with a different port."),(0,a.kt)("p",null,"Clients \"learn\" the router's address and port when they poll the controller for authorized routers, so it is not necessary to re-enroll or re-create the client if the router's address or port changes. Simply change the config, bounce the router, and it will begin advertising the new address and port. This works because the system service and Docker container both auto-renew their server certificate every startup, and the certificate's DNS subject alternative name is set in the router's config.yml file. If you set ",(0,a.kt)("inlineCode",{parentName:"p"},"ZITI_AUTO_RENEW_CERTS=false")," then it's necessary to administratively re-create the router or run at least once with the ",(0,a.kt)("inlineCode",{parentName:"p"},"--extend")," flag."),(0,a.kt)("h2",{id:"logging"},"Logging"),(0,a.kt)("p",null,"View the router service's output with ",(0,a.kt)("inlineCode",{parentName:"p"},"journalctl -u ziti-router.service"),"."),(0,a.kt)(o.Z,{mdxType:"Tabs"},(0,a.kt)(i.Z,{value:"goformats",label:"Log Formats",mdxType:"TabItem"},(0,a.kt)("p",null,"Choose the logging format (default: text)."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"pfxlog")," - a human-readable format leveraging ANSI escape codes to colorize log levels"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"json")," - a machine-readable format targeting automated processes for log aggregation"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"text")," - a human-readable format using plain text (no ANSI escape codes)")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text",metastring:'title="Run without colorized log levels"',title:'"Run',without:!0,colorized:!0,log:!0,'levels"':!0},"ziti router run config.yml --log-formatter text\n"))),(0,a.kt)(i.Z,{value:"golevels",label:"Log Levels",mdxType:"TabItem"},(0,a.kt)("p",null,"The default log level is ",(0,a.kt)("inlineCode",{parentName:"p"},"INFO"),". This means that log messages ",(0,a.kt)("inlineCode",{parentName:"p"},"INFO"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"WARNING"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"ERROR"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"FATAL")," will all be emitted. Enable verbose logging by adding ",(0,a.kt)("inlineCode",{parentName:"p"},"--verbose or -v")," to the command being executed. Verbose mode will additionally emit ",(0,a.kt)("inlineCode",{parentName:"p"},"DEBUG")," log level messages."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text",metastring:'title="Run the controller with verbose (DEBUG, 4) log level"',title:'"Run',the:!0,controller:!0,with:!0,verbose:!0,"(DEBUG,":!0,"4)":!0,log:!0,'level"':!0},"ziti router run config.yml --verbose\n")))),(0,a.kt)("h2",{id:"uninstall"},"Uninstall"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"sudo systemctl disable --now ziti-router.service\nsudo systemctl clean --what=state ziti-router.service\n")))}h.isMDXComponent=!0}}]);